---
title: "Untitled"
author: "Lovianora Saragih"
date: "`r Sys.Date()`"
output: html_document
---

```{r}
library(readxl)

file_path <- "C:/Users/NITRO V15/Downloads/Karakteristik Mahasiswa .xlsx"
data_mahasiswa <- read_excel(file_path, sheet = 1) # Asumsi data berada di Sheet pertama

names(data_mahasiswa) <- gsub(" :", "", names(data_mahasiswa))
names(data_mahasiswa) <- gsub(" ", "_", names(data_mahasiswa))
names(data_mahasiswa) <- gsub(":", "", names(data_mahasiswa))
names(data_mahasiswa) <- gsub("\\(|\\)", "", names(data_mahasiswa))
names(data_mahasiswa) <- gsub("-", "_", names(data_mahasiswa))

data_mahasiswa$IPK_Terakhir <- as.numeric(data_mahasiswa$IPK_Terakhir)
data_mahasiswa$Keterlibatan_Organisai <- as.factor(data_mahasiswa$Keterlibatan_Organisai)

data_anova <- na.omit(data_mahasiswa[, c("IPK_Terakhir", "Keterlibatan_Organisai")])

model_anova <- aov(IPK_Terakhir ~ Keterlibatan_Organisai, data = data_anova)

summary(model_anova)
```
```{r}
library(ggplot2)
library(dplyr)

ringkasan_ipk <- data_anova %>%
  group_by(Keterlibatan_Organisai) %>%
  summarise(
    N = n(),
    Rata_rata_IPK = mean(IPK_Terakhir, na.rm = TRUE),
    SD_IPK = sd(IPK_Terakhir, na.rm = TRUE),
    Median_IPK = median(IPK_Terakhir, na.rm = TRUE)
  )

print(ringkasan_ipk)

boxplot_ipk <- ggplot(data_anova, aes(x = Keterlibatan_Organisai, y = IPK_Terakhir, fill = Keterlibatan_Organisai)) +
  geom_boxplot() +
  labs(
    title = "Distribusi IPK Terakhir berdasarkan Keterlibatan Organisai",
    x = "Keterlibatan Organisai",
    y = "IPK Terakhir"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c(
  "Aktif kegiatan akademik" = "#FFF9A6",  # kuning pastel
  "Aktif organisasi kemahasiswaan" = "#FFE066",  # kuning lembut
  "Lainnya" = "#FFC93C",  # kuning keemasan
  "Tidak Aktif" = "#E0A800"  # deep golden
))



print(boxplot_ipk)

histogram_ipk <- ggplot(data_anova, aes(x = IPK_Terakhir)) +
  geom_histogram(aes(y = after_stat(density)), bins = 30, fill = "lightblue", color = "black") +
  geom_density(color = "red") +
  labs(
    title = "Histogram dan Kurva Kepadatan IPK Terakhir",
    x = "IPK Terakhir",
    y = "Kepadatan"
  ) +
  theme_minimal()

print(histogram_ipk)


library(ggplot2)
library(dplyr)

# Kolom organisasi
kolom_org <- "Keterlibatan_Organisai"

# Tabel frekuensi
org_tab <- table(data_anova[[kolom_org]])
org_summary <- data.frame(
  Kategori_Organisasi = names(org_tab),
  Freq = as.numeric(org_tab)
)

# Hitung proporsi dan posisi label
org_summary <- org_summary %>%
  mutate(
    Fraction = Freq / sum(Freq),
    Percent = round(Fraction * 100, 1),
    Label = paste0(Percent, "%"),
    # posisi label: cumulative sum minus setengah fraction
    ypos = cumsum(Fraction) - 0.5 * Fraction
  )

# Donut chart
library(readxl)
library(ggplot2)
library(dplyr)

file_path <- "C:/Users/NITRO V15/Downloads/Karakteristik Mahasiswa .xlsx"
data_mahasiswa <- read_excel(file_path, sheet = 1) 

names(data_mahasiswa) <- gsub(" :| |:|\\(|\\)|-", "", names(data_mahasiswa))

data_mahasiswa$KeterlibatanOrganisai <- as.factor(data_mahasiswa$KeterlibatanOrganisai)

data_donat <- na.omit(data_mahasiswa[, c("KeterlibatanOrganisai")])

data_proporsi <- data_donat %>%
  group_by(KeterlibatanOrganisai) %>%
  summarise(N = n(), .groups = 'drop') %>%
  mutate(
    Persentase = N / sum(N) * 100,
    Label_Posisi = cumsum(Persentase) - 0.5 * Persentase,
    ymax = cumsum(Persentase),
    ymin = ymax - Persentase
  )

palet_warna_baru <- c("#b3cde0", "#6497b1", "#005b96", "#03396c")

diagram_donat <- ggplot(data_proporsi, aes(ymax = ymax, ymin = ymin, xmax = 4, xmin = 3, fill = KeterlibatanOrganisai)) +
  geom_rect(color = "white") +
  coord_polar(theta = "y") +
  
  geom_text(aes(label = paste0(round(Persentase, 1), "%"), x = 3.5, y = Label_Posisi), color = "black", size = 4) +

  scale_fill_manual(values = palet_warna_baru) +

  labs(
    title = "Proporsi Keterlibatan Organisai Mahasiswa",
    fill = "Keterlibatan Organisai"
  ) +
  theme_void() +
  xlim(c(2, 4)) + 
  theme(
    legend.position = "right",
    plot.title = element_text(hjust = 0.5, face = "bold")
  )

print(diagram_donat)


```
```

